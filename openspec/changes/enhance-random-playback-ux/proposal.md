# Proposal: enhance-random-playback-ux

## Summary

改进随机播放功能的用户体验：默认折叠随机歌曲列表界面，并在播放完所有队列歌曲后自动继续添加随机歌曲。

## Motivation

当前随机播放存在两个体验问题：

1. **界面占用**：点击随机播放后，歌曲列表会展开占用屏幕空间，影响移动端用户体验
2. **播放中断**：当队列中的歌曲全部播放完毕后，播放会停止，用户需要手动再次点击随机播放

## Scope

- **IN**: 随机播放列表默认折叠、队列耗尽时自动补充随机歌曲
- **OUT**: 不改变现有搜索功能、不改变播放控制逻辑

## Approach

1. 为随机播放结果添加独立的折叠状态（默认折叠）
2. 在 `usePlayer` 中检测队列即将耗尽，自动调用 toplist API 获取更多歌曲并追加到队列

## Dependencies

- 现有 `/api/music/toplist` API
- 现有 `shuffleArray` 工具函数

## Risks

- 自动添加可能导致用户意外消耗流量（可接受，符合"随机播放"预期）
